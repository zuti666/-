#      第三章概率密度函数的估计  

如何用样本集估计概率密度函数

估计概率密度的两种方法

1. 参数方法(parametric methods)

2. 非参数方法(nonparametric methods)

   

本章要求估计总体分布的具体参数，是个点估计问题：最大似然估计和贝叶斯估计

判断估计好坏标准：无偏性，有效性及一致性

## 3.2最大似然估计

### 假设条件：

![](第三章 概率密度函数的估计.assets/图片1.jpg)

若抽样的结果得到样本观测值$x_1,x_1,\cdots，x_n$，我们应当选取参数$\theta_i$的值，使这组样本观测值出现的结果的可能性最大，即构造似然函数：
$$
\begin{aligned}
L(\theta_1,\theta_2,\cdots,\theta_k)&=P(X_1=x_1,X_2=x_2,\cdots,X_n=x_n)\\
                          			&=P(X_1=x_1)P(X_2=x_2)\cdots P(X_n=x_n) \\
                          			&=p(x_1,\theta_1,\cdots,\theta_k)p(x_2,\theta_1,\cdots,\theta_k)\cdots p(p(x_n,\theta_1,\cdots,\theta_k)) \\
                          			&=\prod_{i=1}^np(x_i,\theta_1,\cdots,\theta_k)
\end{aligned}
$$
使$L(\theta_1,\cdots,\theta_k)$达到最大，从而得到参数$\theta_i$的估计值$\hat{\theta_i}$。此估计值称为**极大似然估计值**。函数$L(\theta_1,\cdots,\theta_k)$称为**似然函数**。

求极大似然估计值的问题，就是求似然函数$L(\theta_1,\cdots,\theta_k)$的最大值问题，则
$$
\frac{\partial L}{\partial \theta_i}=0 \ i=1,2,\dots,k \\
即 \frac{\partial ln L}{\partial \theta_i}=0 \ i=1,2,\dots,k
$$

#### 

## 3.3 贝叶斯估计和贝叶斯学习

**贝叶斯估计**

思路与贝叶斯决策类似，只是离散的决策状态变成了连续的估计。

**基本思想：**

把待估计参数$θ$看作具有先验分布$p(θ)$的随机变量，其取值与样本集X有关，根据样本集$X={x_1,x_2,⋯,x_N }$估计$θ$。

**损失函数**：

 				把$θ$估计为$θ$   所造成的损失，记为$λ(θ ̂,θ)$

**期望风险**：
$$
\begin{aligned}
R=& \int_{E^d} \int_\Theta \lambda(\hat{\theta},\theta)p(x,\theta)d\theta dx \\
=&\int_{E^d} \int_\Theta \lambda(\hat{\theta},\theta)p(\theta|x)p(x)d\theta dx \\
=&\int_{E^d}R(\hat{\theta},\theta)p(x)dx \\
其中 x \in E^d ,\theta \in \Theta

\end{aligned}
$$


**条件风险**：
$$
R(\hat{\theta},\theta)=\int_\theta \lambda(\hat{\theta},\theta)p(\theta|x)d\theta
$$


最小化期望风险   $  \Rightarrow  
  $ 最小化条件风险  （对所有可能的x）

有限样本集下，最小化经验风险：
$$
R(\hat{\theta},\theta)=\int_\theta \lambda(\hat{\theta},\theta)p(\theta|x)d\theta
$$
**贝叶斯估计量：**（在样本集$X$下）使条件风险（经验风险）最小的估计量$θ$ 

#### ***定理3.1**　                        

如果采用平方误差损失函数，则$θ$的贝叶斯估计量$\hat{\theta}$是在给定$x$时$θ$的条件期望，即 
$$
\hat{\theta}=E[\theta|x]=\int_\Theta\theta p(\theta|x)d\theta
$$
同理可得到，在给定样本集$X$下，$θ$的贝叶斯估计是：
$$
\hat{\theta}=E[\theta|X]=\int_\Theta\theta p(\theta|X)d\theta
$$

### **求贝叶斯估计的方法：**（平方误差损失下）

1. 确定$θ$的先验分布$ p(θ)$

2. 求样本集的联合分布
   $$
   p(X|\theta)=\prod_{i=1}^Np(x_i|\theta)
   $$
   

3. 求$θ$的后验概率分布 
   $$
   p(\theta|X)=\frac{p(X|\theta)p(\theta)}{\int_\Theta\theta p(x|\theta )p(\theta)d\theta}
   $$
   

4. 求$θ$的贝叶斯估计量 
   $$
   \hat{\theta}=\int_\Theta\theta p(\theta|X)d\theta
   $$
   

  我们也可直接推断总体分布
$$
p(x|X)=\int_\Theta p(x|\theta) \  p(\theta|X)d\theta \\
其中 p(\theta|X)=\frac{p(X|\theta)p(\theta)}{\int_\Theta\theta p(x|\theta )p(\theta)d\theta}
$$
